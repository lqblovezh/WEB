Reader (v3.x)
===

技术体系
---

__React + Mobx + Webpack + Babel + PostCSS__

项目结构
---

    reader3/
    ├── ...
    ├── src // 源代码目录
    │   ├── components // React 组件部分，仅作为 View 使用
    │   │   ├── App // 程序主组件，可自动识别设备
    │   │   └── desktop
    │   │       ├── ...
    │   │       └── Layout  // 桌面版主组件
    │   ├── core // 核心库
    │   │   ├── conf
    │   │   │   ├── ...
    │   │   │   └── schema.es  // 内容渲染规则缺省配置
    │   │   ├── ...
    │   │   ├── parse.es  // XML --> Metadata
    │   │   ├── serialize.es  // Metadata --> HTML
    │   │   ├── splitPage.es  // 流式分页
    │   │   └── splitPageByPageNumber.es  // 固定分页
    │   ├── stores // 数据管理类，用于数据存储、修改、逻辑处理等
    │   │   ├── ...
    │   │   └── createStores.es // 实例化
    │   ├── themes  // 外部 CSS 样式主题库，需要单独在页面中引用
    │   │   ├── ...
    │   │   └── index.css // 主题导出入口文件
    │   ├── utils // 通用工具库
    │   │   └── ...
    │   ├── service.dev.es  // 外部交互接口调式文件（作为临时使用，接口应由业务系统实现）
    │   ├── settings.es // 程序缺省配置
    │   ├── ...
    │   └── index.es // 程序导出入口文件
    ├── out // 文件导出目录
    │   ├── index.html // 阅读器演示页面
    │   ├── VERSION // git版本号(注:需要先提交再打包)
    │   ├── COMMITHASH // git完整版本号
    │   ├── reader3.css // 基本结构样式文件(webpack生成)
    │   ├── reader3.themes.css // 主题样式文件(postcss生成)
    │   ├── polyfill.min.js // 低版本浏览器需要引用
    │   └── reader3.js // 程序主文件(webpack生成)
    └── test // 测试环境模拟

项目调试/构建
---

```sh
# 启动调试环境，访问 http://127.0.0.1:4430/reader/index.html 可打开主程序
npm test

# 项目构建，输出发布文件
npm run compile
```

主程序选项说明
---

```js
var reader = new Reader3({
  //...
})
reader.mount(document.getElementById('root'))

reader.unmount()
```

功能列表
---

注：目前仅实现桌面版

### 已实现功能

* 多级目录
* 文本预览（流式布局、竖版流式布局、竖版定式布局）
* 图片预览（缩放、拖拽）
* 图文对照（多图文、缩放、拖拽、窗口可拖拽和改变尺寸）
* 动态设置（字体、字号、文字及背景等）
* 本书全文搜索
* 批注（对选中文本进行注释）
* 复制选中文本

### 待实现的功能

_本期无_

### 实验功能

* `docbook` 数据格式解析

### 展望功能

* 推送看过，或正在看这本书的用户


开发注意事项
---

1. 在较低版本浏览器中，需要在页面中引用 `polyfill` 库。
1. __Mobx__ 已启用严格模式，即：如果 `observable` 值被 `observer` 限制, 只能通过 `action` 修改这个值。
1. 在样式文件中，如果没有样式内容，请勿删除，可能是用于根据文本布局等操作。


参考链接
---

* [前端编码规范](http://note.youdao.com/share/?id=63225de647e24196a70ae5a6938dd86e&type=note#/)

开发日志
---

待完成
* __[功能优化]__ 批注与关键字共存
* __[功能优化]__ 关键字跨段定位不准确
* __[功能优化]__ 复制限制（提示复制字数）
* __[新功能]__ 内容统一样式引入

2012-12-12
* __[功能优化]__ 横竖版区分
* __[新功能]__ 古文单双行注解（小字）
* __[新功能]__ 处理 xml 中的内联样式，用于现代文
* __[功能优化]__ 对照图标识更换


2017-12-07
* __[功能优化]__ 搜索结果高亮，定位

2017-12-04
* __[新功能]__ 批注文字对照（突出可点击查看的效果）

2017-11-30
* __[BUG]__ 地址栏路径未同步
* __[BUG]__ 往上一章翻时，定位到最后一页
* __[BUG]__ 定版固定高度
* __[BUG]__ 取消批注算法问题
* __[BUG]__ 批注未立即高亮

2017-11-29
* __[BUG]__ 文字布局切换时，滚动条优化
* __[BUG]__ 定版情况，图文对照不一致

2017-11-28
* __[功能优化]__ 目录高亮当前章节
